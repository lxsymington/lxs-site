---
title: "Gradients from the ground up"
date: "2020-06-10"
description: "Starting at the fundamentals and working up"
tags: ["visuals", "css", "gradients"]
---

## **Preamble**
As this is my first post I thought that I would start with something relatively simple. Given that I am
currently building this site and being an engineer I don't have much in the way of images, I have been using gradients
in an effort to make the site more visually appealing (hopefully something that I have achieved). As such I thought that
I would take this opportunity to look deeper into how they work and behave in CSS, thereby keeping a record of what I
have learnt about them.

## **Introduction**
### **Positives**
Gradients are a transition from one colour to one or more other colours over a specified distance. So why are gradients
interesting? For a start when used as backgrounds they can bring more visual depth and texture than their flat
counterparts. Creating visual depth can help to break up content, making it more approachable and therefore consumable.
Appropriate use of gradients can also be used to draw attention to key content by making it more stimulating as well as
intelligent use of light.

### **Negatives**
Gradients do also have their downsides. As much as they can draw attention to key areas, as well as help to contextually
separate content when used well, they can also be distracting and divert users away from key content. Another area
gradients *can*, but do not necessarily need to, cause problems is accessibility. Much the same as with text over
images, text over gradients can often cause readability issues. The readability issues often arise from a lack of
contrast between the text/foreground colour and the colour of the background over which it is presented. Unfortunately
this is still a common issue on the web even when using flat colours, let alone when text is displayed ove a background that has
multiple colours such as an image or gradient. With a little thought and a modicum of effort though there is usually
ample opportunity to improve the situation for everyone!

***

_It has been fairly widely acknowledged that the web needs to more to be accessible to all users, as accessibility
benefits everyone often in ways that are not immediately obvious. As a Frontend engineer and someone who spends most of
their time working, creating user interfaces, I want to ensure that accessible practices are always considered. I am
very much at the start of the journey towards incorporating accessible practices as a default as opposed to
retrospectively, but hopefully with a little learning, a little feedback and some time I will get there._

## **Basic varieties**
As touched upon earlier in this post in the context of CSS gradients, a gradient is a transition from a colour to one or
more colours over a specified distance. What was not discussed at that point was the direction of that transition. In
gradients generally that is not important however in CSS gradients there are currently 6 varieties of gradient which can be
divided into 3 categories:

 - **Linear**
   CSS `linear-gradient`s can be thought of as being unidirectional, as in they transition from a start point to an end
   point along the straight line that connects them. 

 - **Radial**
   CSS `radial-gradient`s can be thought of as being omnidirectional, as in they transition from a start point in all
   directions up to a specified distance from the start point. How this distance is specified is a little more
   complicated than it is for linear gradients, therefore it is something that I will revisit later on in this post.

 - **Conic**
   CSS `conic-gradient`s are a little more different from the other 2 varieties in that they do not transition along (a)
   straight line(s). Instead they transition from a start angle to an end angle about a specified point.
   `conic-gradient`s are a newer addition to the CSS spec and therefore not implemented in some commonly used browsers,
   consequently this post will focus more on the other two categories.

Each of the above categories have a default and repeating variety. The total span of the gradients produced by each
variety of a category will be the same, however, a repeating variety will likely contain multiple instances of the same
transition, where the default variety will only contain one instance. It is worth noting that a _transition_ here can
contain multiple `color-stop`s and `color-hint`s that will add colours to the transition, i.e. a single transition could
go from purple to yellow via orange, red and magenta. At this point it is probably worth looking at some examples.

## **Linear Gradients**
Below is probably the simplest declaration of a gradient in CSS. It declares a two colour gradient (the minimum
required) without an `angle` or positions for the `color-stop`s. In the case where a direction is omitted, the
[spec](https://www.w3.org/TR/css-images-3/#linear-gradient-syntax)
states that it defaults to '`to bottom`'. Simarlarly if positions are not declared for the first and last
`color-stops` the [spec](https://www.w3.org/TR/css-images-3/#color-stop-syntax) states that their positions should
default to 0% and 100% respectively. It also states that when one or more `color-stop`s which are not the first or last and
their positions are omitted, then they are spaced evenly between the surrounding positioned `color-stops`.

To view and interact with the source declaration click the _"Open Editor"_ button.

```css caption=Simple_Gradient
/*----------------------------------------------------------------------------*\
 *
 * The declaration of the `background-image` CSS property that results in the
 * accompanying two tone gradient.
 *
 * Try changing the `color`s to something different, for example: `grey`,
 * `green`, `#57316b`, hsla(352deg 68% 59% / 80%) etc.
 * 
 * Alternatively add a new `color-stop` - a `color` followed by a comma unless
 * it is the last in the list.
 *
\*----------------------------------------------------------------------------*/
background-image: linear-gradient(black, transparent);
```

In an effort to keep this post focussed, while other CSS properties have been applied to the preview they are not shown
in the _"source"_, they only serve the purpose of giving the preview a size and fitting it in with layout of this page.
A `selector` is also used to target the `class` `attribute` of the preview `element`. The `declaration`s shown in the _"source"_ are
inserted into the CSS `rule` that targets the preview's `selector`.

### **_A picture is worth a thousand words_**
&hellip;or so the adage goes. Ideally the gradient pictured above will have been the expected result, given the information
in this post so far, and if not hopefully it has brought some clarity. With the visual aid of the above example it may
be easier to go over how the transition from one colour to the next is resolved.

So we probably need to talk about colour representation in browsers. To make the web more accessible there are a number
of `color` name `keyword`s these are more memorable shorthands that will resolve to a particular `color` value in `sRGB`
`colorspace` <sup>1</sup>. This means that it is possible to set a `color` to be `red`, `coral`, `purple` etc. and the
browser will know what to display, however, there are only a finite number of these (140 infact) and they are
pre-defined which is quite limiting &mdash; the web would be rather homogenous if we could only use 140 colours! So what
did that `sRGB` `colorspace` bit mean? Well there are lots of different ways of thinking about colour, but one that
lends itself to being displayed on a screen is to think of a colour as being made up of different amounts of coloured
light. For example if we start with scene with no light then the colour of the scene is black, if we were to shine a red
light on the scene the colour of the scene would become red. If we were then to additionally shine a green light in
equal amount to the red light on the scene it would result in a yellow colour. Finally if we were to shine a blue light
on the scene as well, the scene would appear illuminated with white coloured light. By varying the amounts of these
three coloured lights we can make the scene almost any colour required. This type of colour system is called "additive"
in contrast to paint or ink based colour systems which are called "subtractive" &mdash; adding dye or pigment
filters out light. So going back to `sRGB`, if we now expand the acronym to the full name `standard Red Green Blue`
`colorspace` the reason for choosing red, green and blue light in the earlier thought experiment may become apparent. As
a side note the reason for red, green and blue being used as the _primary colours_ is purportedly related to the types
of cone cells there are in the human retina, and the colour of the light they are most sensitive to. The last thing to
address is the `standard` part of `sRGB`, it is important not to skip over this as it reflects that `sRGB` is
device-independent, so regardless of a devices capabilities provided that it is `sRGB` capable it will display the same
colour. How does all this relate to gradients? We now know that we can represent colours as a list of amounts of red,
blue and green light, amounts otherwise known as _'channels'_. For example `red: 50%, green: 60%, blue: 70%`.

Having discussed colour representation we should probably get back to `linear-gradient`. Since **fig. 1** is one of the
most straightforward examples of a gradient lets take that as a starting point. The actual size of the preview gradient
will vary depending on the device it is being viewed on but if we think of it as being 100 pixels in height it will
help. To summarise the gradient we are considering has a direction of `to bottom` with a start colour of `black` at the
default position of `0%` and an end colour of `white` at the default position of `100%`. Lets consider how this will get
displayed on our screens, starting with the first row of pixels. Given that this is the first row of pixels in a
gradient that is 100 pixels high the top of the the row is offset 0 pixels or 0% from the top and the bottom of the row
is offset 1 pixel or 1% from the top as each pixel can only be painted one colour we need to find the average colour for
this section of the gradient line. We also know that all the pixels in this row should be the same colour because the
row is perpendicular to the `gradient-line` and therefore every pixel in this row is the same distance along the
`gradient-line`, this holds true for subsequent rows as well. Since this is a `linear-gradient` we know that there is a
linear relationship between the displacement along the gradient line in pixels and the percentage _colour shift_, in
fact as we are considering a 100 pixel gradient they are directly proportional meaning for each pixel of displacement
along the `gradient-line` the _colour shift_ increases by a percent. Therefore we know that average colour of a row will
be the same as that of the theoretical `gradient-line` at the pixel row's vertical **midpoint**. For the first row of
pixels this will be at &frac12; a pixel along the gradient line. We now also know that colours can be represented
numerically, which makes transforming and scaling them much easier. For instance `black`, the starting colour of our
gradient, can also be described as `rgb(0, 0, 0)` (0 red light, 0 green light and 0 blue light) and the ending colour
`white`, as `rgb(100% 100% 100%)` &mdash; more commonly written `rgb(255, 255, 255)`. There is also a similar, commonly
used, shorter way of describing `RGB` colours using a triplet of 2 digit hexadecimal numbers written in the form
`#RRGGBB`, in the case of `black` this is: `#000000`. In our example a &frac12;% shift from `black` to `white` would be
`rgb(0.5%, 0.5%, 0.5%)` which seems fairly straightforward. To make matters a little more complicated most devices will
be display 24-bit or "true" colour, this means that the device can displa <abbr title="16,777,216">2<sup>24</sup></abbr>
colours. These are made from 256 (0 - 255) values in each colour channel that can be blended together.

<sup>1</sup>

At the time of writing Lab and LCH colorspaces have been defined in the CSS color level 4 spec but are yet to be
implemented in any widely used browsers.

---
***
---

For the sake of clarity, I would like to take a moment to explain what I mean by the _"double stop technique"_. **_Fig.
1_** is an example of what is probably the simplest implementation of a CSS `linear-gradient`.

In **_fig. 1_** there are two `color-stop`s the first stop `black` and the last stop `transparent`. In this instance the
`color-stop` positions have been omitted for simplicity, the result is that the first and last stops are placed at the
start (0%) an end (100%) of the gradient line respectively. If we do set the positions for the `color-stop`s we can
reduce the size of the transition between the two colours as shown in **_fig. 2_**.

```css caption=Positioned_Color_Stop_Gradient
background-image: linear-gradient(black 25%, transparent 75%);
```

## **Rough around the edges**

If we continue to move the `color-stop` positions closer together, eventually we get to the point where they share the
same position.

For example:

```css caption=Vertical_and_Horizontal_Gradient_Lines
background-image:
  repeating-linear-gradient(
    transparent 0 12px,
    black 12px calc(12px + 1px / var(--dpr)),
    transparent calc(12px + 1px / var(--dpr)) 25px
  ),
  repeating-linear-gradient(
    90deg,
    transparent 0 12px,
    black 12px calc(12px + 1px / var(--dpr)),
    transparent calc(12px + 1px / var(--dpr)) 25px
  );
background-position: center;
```

As is shown in the above example this produces decent results for horizontal and vertical lines.

```css caption=45_degree_Gradient_Lines
background-image:
  repeating-linear-gradient(
    45deg,
    transparent 0 12px,
    black 12px calc(12px + 1px / var(--dpr)),
    transparent calc(12px + 1px / var(--dpr)) 25px
  ),
  repeating-linear-gradient(
    135deg,
    transparent 0 12px,
    black 12px calc(12px + 1px / var(--dpr)),
    transparent calc(12px + 1px / var(--dpr)) 25px
  );
background-position: center;
```

Unfortunately I found this experimentation mostly produced poor results. Not one to be put off when things don't work
first time, I decided to have a go at improving the results.

```css caption=30_degree_Gradient_Lines
background-image:
  repeating-linear-gradient(
    30deg,
    transparent 0 12px,
    black 12px calc(12px + 1px / var(--dpr)),
    transparent calc(12px + 1px / var(--dpr)) 25px
  ),
  repeating-linear-gradient(
    120deg,
    transparent 0 12px,
    black 12px calc(12px + 1px / var(--dpr)),
    transparent calc(12px + 1px / var(--dpr)) 25px
  );
background-position: center;
```

```css caption=60_degree_Gradient_Lines
background-image:
  repeating-linear-gradient(
    60deg,
    transparent 0 12px,
    black 12px calc(12px + 1px / var(--dpr)),
    transparent calc(12px + 1px / var(--dpr)) 25px
  ),
  repeating-linear-gradient(
    150deg,
    transparent 0 12px,
    black 12px calc(12px + 1px / var(--dpr)),
    transparent calc(12px + 1px / var(--dpr)) 25px
  );
background-position: center;
```

```css caption=Graded_60_degree_Gradient_Lines
background-image:
  repeating-linear-gradient(
    60deg,
    transparent 0 11px,
    calc(11px + 1px / var(--dpr)),
    black,
    calc(11px + 2px / var(--dpr)),
    transparent calc(11px + 3px / var(--dpr)) 25px
  ),
  repeating-linear-gradient(
    150deg,
    transparent 0px 11px,
    calc(11px + 1px / var(--dpr)),
    black,
    calc(11px + 2px / var(--dpr)),
    transparent calc(11px + 3px / var(--dpr)) 25px
  );
background-position: center;
```

```css caption=Circular_Radial_Gradient
background-image:
  repeating-radial-gradient(
    circle at 50% 50%,
    transparent 0 12px,
    black 12px calc(12px + 1px / var(--dpr)),
    transparent calc(12px + 1px / var(--dpr)) 25px
  );
background-position: center;
```

```css caption=Graded_Circular_Radial_Gradient
background-image:
  repeating-radial-gradient(
    circle at 50% 50%,
    transparent 0 11px,
    calc(11px + 1px / var(--dpr)),
    black,
    calc(11px + 2px / var(--dpr)),
    transparent calc(11px + 3px / var(--dpr)) 25px
  );
background-position: center;
```

```css caption=Elliptical_Radial_Gradient
background-image:
  repeating-radial-gradient(
    ellipse at 50% 50%,
    transparent 0 12px,
    black 12px calc(12px + 1px / var(--dpr)),
    transparent calc(12px + 1px / var(--dpr)) 25px
  );
background-position: center;
```

```css caption=Graded_Elliptical_Radial_Gradient
background-image:
  repeating-radial-gradient(
    ellipse at 50% 50%,
    transparent 0 11px,
    calc(11px + 1px / var(--dpr)),
    black,
    calc(11px + 2px / var(--dpr)),
    transparent calc(11px + 3px / var(--dpr)) 25px
  );
background-position: center;
```

